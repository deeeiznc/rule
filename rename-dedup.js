/**
 * Usage: Add a script operation to the Sub-Store
 * Parameter example: #flag&blkey=GPT>new name+NF
 */
const inArg = $arguments,
  {
    nx = false,
    bl = false,
    nf = false,
    blgd = false,
    blpx = false,
    blnx = false,
    debug = false,
    clear = false,
    nm = false,
    flag: addflag = false,
  } = inArg,
  FGF = decodeURI(inArg.fgf ?? " "),
  FNAME = decodeURI(inArg.name ?? ""),
  BLKEY = decodeURI(inArg.blkey ?? ""),
  blockquic = decodeURI(inArg.blockquic ?? "");

const abbr = [
    "HK",
    "MO",
    "TW",
    "JP",
    "KR",
    "SG",
    "US",
    "GB",
    "FR",
    "DE",
    "AU",
    "AE",
    "AF",
    "AL",
    "DZ",
    "AO",
    "AR",
    "AM",
    "AT",
    "AZ",
    "BH",
    "BD",
    "BY",
    "BE",
    "BZ",
    "BJ",
    "BT",
    "BO",
    "BA",
    "BW",
    "BR",
    "VG",
    "BN",
    "BG",
    "BF",
    "BI",
    "KH",
    "CM",
    "CA",
    "CV",
    "KY",
    "CF",
    "TD",
    "CL",
    "CO",
    "KM",
    "CG",
    "CD",
    "CR",
    "HR",
    "CY",
    "CZ",
    "DK",
    "DJ",
    "DO",
    "EC",
    "EG",
    "SV",
    "GQ",
    "ER",
    "EE",
    "ET",
    "FJ",
    "FI",
    "GA",
    "GM",
    "GE",
    "GH",
    "GR",
    "GL",
    "GT",
    "GN",
    "GY",
    "HT",
    "HN",
    "HU",
    "IS",
    "IN",
    "ID",
    "IR",
    "IQ",
    "IE",
    "IM",
    "IL",
    "IT",
    "CI",
    "JM",
    "JO",
    "KZ",
    "KE",
    "KW",
    "KG",
    "LA",
    "LV",
    "LB",
    "LS",
    "LR",
    "LY",
    "LT",
    "LU",
    "MK",
    "MG",
    "MW",
    "MY",
    "MV",
    "ML",
    "MT",
    "MR",
    "MU",
    "MX",
    "MD",
    "MC",
    "MN",
    "ME",
    "MA",
    "MZ",
    "MM",
    "NA",
    "NP",
    "NL",
    "NZ",
    "NI",
    "NE",
    "NG",
    "KP",
    "NO",
    "OM",
    "PK",
    "PA",
    "PY",
    "PE",
    "PH",
    "PT",
    "PR",
    "QA",
    "RO",
    "RU",
    "RW",
    "SM",
    "SA",
    "SN",
    "RS",
    "SL",
    "SK",
    "SI",
    "SO",
    "ZA",
    "ES",
    "LK",
    "SD",
    "SR",
    "SZ",
    "SE",
    "CH",
    "SY",
    "TJ",
    "TZ",
    "TH",
    "TG",
    "TO",
    "TT",
    "TN",
    "TR",
    "TM",
    "VI",
    "UG",
    "UA",
    "UY",
    "UZ",
    "VE",
    "VN",
    "YE",
    "ZM",
    "ZW",
    "AD",
    "RE",
    "PL",
    "GU",
    "VA",
    "LI",
    "CW",
    "SC",
    "AQ",
    "GI",
    "CU",
    "FO",
    "AX",
    "BM",
    "TL",
  ],
  zh = [
    "é¦™æ¸¯",
    "æ¾³é—¨",
    "å°æ¹¾",
    "æ—¥æœ¬",
    "éŸ©å›½",
    "æ–°åŠ å¡",
    "ç¾Žå›½",
    "è‹±å›½",
    "æ³•å›½",
    "å¾·å›½",
    "æ¾³å¤§åˆ©äºš",
    "é˜¿è”é…‹",
    "é˜¿å¯Œæ±—",
    "é˜¿å°”å·´å°¼äºš",
    "é˜¿å°”åŠåˆ©äºš",
    "å®‰å“¥æ‹‰",
    "é˜¿æ ¹å»·",
    "äºšç¾Žå°¼äºš",
    "å¥¥åœ°åˆ©",
    "é˜¿å¡žæ‹œç–†",
    "å·´æž—",
    "å­ŸåŠ æ‹‰å›½",
    "ç™½ä¿„ç½—æ–¯",
    "æ¯”åˆ©æ—¶",
    "ä¼¯åˆ©å…¹",
    "è´å®",
    "ä¸ä¸¹",
    "çŽ»åˆ©ç»´äºš",
    "æ³¢æ–¯å°¼äºšå’Œé»‘å¡žå“¥ç»´é‚£",
    "åšèŒ¨ç“¦çº³",
    "å·´è¥¿",
    "è‹±å±žç»´äº¬ç¾¤å²›",
    "æ–‡èŽ±",
    "ä¿åŠ åˆ©äºš",
    "å¸ƒåŸºçº³æ³•ç´¢",
    "å¸ƒéš†è¿ª",
    "æŸ¬åŸ”å¯¨",
    "å–€éº¦éš†",
    "åŠ æ‹¿å¤§",
    "ä½›å¾—è§’",
    "å¼€æ›¼ç¾¤å²›",
    "ä¸­éžå…±å’Œå›½",
    "ä¹å¾—",
    "æ™ºåˆ©",
    "å“¥ä¼¦æ¯”äºš",
    "ç§‘æ‘©ç½—",
    "åˆšæžœ(å¸ƒ)",
    "åˆšæžœ(é‡‘)",
    "å“¥æ–¯è¾¾é»ŽåŠ ",
    "å…‹ç½—åœ°äºš",
    "å¡žæµ¦è·¯æ–¯",
    "æ·å…‹",
    "ä¸¹éº¦",
    "å‰å¸ƒæ",
    "å¤šç±³å°¼åŠ å…±å’Œå›½",
    "åŽ„ç“œå¤šå°”",
    "åŸƒåŠ",
    "è¨å°”ç“¦å¤š",
    "èµ¤é“å‡ å†…äºš",
    "åŽ„ç«‹ç‰¹é‡Œäºš",
    "çˆ±æ²™å°¼äºš",
    "åŸƒå¡žä¿„æ¯”äºš",
    "æ–æµŽ",
    "èŠ¬å…°",
    "åŠ è“¬",
    "å†ˆæ¯”äºš",
    "æ ¼é²å‰äºš",
    "åŠ çº³",
    "å¸Œè…Š",
    "æ ¼é™µå…°",
    "å±åœ°é©¬æ‹‰",
    "å‡ å†…äºš",
    "åœ­äºšé‚£",
    "æµ·åœ°",
    "æ´ªéƒ½æ‹‰æ–¯",
    "åŒˆç‰™åˆ©",
    "å†°å²›",
    "å°åº¦",
    "å°å°¼",
    "ä¼Šæœ—",
    "ä¼Šæ‹‰å…‹",
    "çˆ±å°”å…°",
    "é©¬æ©å²›",
    "ä»¥è‰²åˆ—",
    "æ„å¤§åˆ©",
    "ç§‘ç‰¹è¿ªç“¦",
    "ç‰™ä¹°åŠ ",
    "çº¦æ—¦",
    "å“ˆè¨å…‹æ–¯å¦",
    "è‚¯å°¼äºš",
    "ç§‘å¨ç‰¹",
    "å‰å°”å‰æ–¯æ–¯å¦",
    "è€æŒ",
    "æ‹‰è„±ç»´äºš",
    "é»Žå·´å«©",
    "èŽ±ç´¢æ‰˜",
    "åˆ©æ¯”é‡Œäºš",
    "åˆ©æ¯”äºš",
    "ç«‹é™¶å®›",
    "å¢æ£®å ¡",
    "é©¬å…¶é¡¿",
    "é©¬è¾¾åŠ æ–¯åŠ ",
    "é©¬æ‹‰ç»´",
    "é©¬æ¥",
    "é©¬å°”ä»£å¤«",
    "é©¬é‡Œ",
    "é©¬è€³ä»–",
    "æ¯›åˆ©å¡”å°¼äºš",
    "æ¯›é‡Œæ±‚æ–¯",
    "å¢¨è¥¿å“¥",
    "æ‘©å°”å¤šç“¦",
    "æ‘©çº³å“¥",
    "è’™å¤",
    "é»‘å±±å…±å’Œå›½",
    "æ‘©æ´›å“¥",
    "èŽ«æ¡‘æ¯”å…‹",
    "ç¼…ç”¸",
    "çº³ç±³æ¯”äºš",
    "å°¼æ³Šå°”",
    "è·å…°",
    "æ–°è¥¿å…°",
    "å°¼åŠ æ‹‰ç“œ",
    "å°¼æ—¥å°”",
    "å°¼æ—¥åˆ©äºš",
    "æœé²œ",
    "æŒªå¨",
    "é˜¿æ›¼",
    "å·´åŸºæ–¯å¦",
    "å·´æ‹¿é©¬",
    "å·´æ‹‰åœ­",
    "ç§˜é²",
    "è²å¾‹å®¾",
    "è‘¡è„ç‰™",
    "æ³¢å¤šé»Žå„",
    "å¡å¡”å°”",
    "ç½—é©¬å°¼äºš",
    "ä¿„ç½—æ–¯",
    "å¢æ—ºè¾¾",
    "åœ£é©¬åŠ›è¯º",
    "æ²™ç‰¹é˜¿æ‹‰ä¼¯",
    "å¡žå†…åŠ å°”",
    "å¡žå°”ç»´äºš",
    "å¡žæ‹‰åˆ©æ˜‚",
    "æ–¯æ´›ä¼å…‹",
    "æ–¯æ´›æ–‡å°¼äºš",
    "ç´¢é©¬é‡Œ",
    "å—éž",
    "è¥¿ç­ç‰™",
    "æ–¯é‡Œå…°å¡",
    "è‹ä¸¹",
    "è‹é‡Œå—",
    "æ–¯å¨å£«å…°",
    "ç‘žå…¸",
    "ç‘žå£«",
    "å™åˆ©äºš",
    "å¡”å‰å…‹æ–¯å¦",
    "å¦æ¡‘å°¼äºš",
    "æ³°å›½",
    "å¤šå“¥",
    "æ±¤åŠ ",
    "ç‰¹ç«‹å°¼è¾¾å’Œå¤šå·´å“¥",
    "çªå°¼æ–¯",
    "åœŸè€³å…¶",
    "åœŸåº“æ›¼æ–¯å¦",
    "ç¾Žå±žç»´å°”äº¬ç¾¤å²›",
    "ä¹Œå¹²è¾¾",
    "ä¹Œå…‹å…°",
    "ä¹Œæ‹‰åœ­",
    "ä¹Œå…¹åˆ«å…‹æ–¯å¦",
    "å§”å†…ç‘žæ‹‰",
    "è¶Šå—",
    "ä¹Ÿé—¨",
    "èµžæ¯”äºš",
    "æ´¥å·´å¸ƒéŸ¦",
    "å®‰é“å°”",
    "ç•™å°¼æ±ª",
    "æ³¢å…°",
    "å…³å²›",
    "æ¢µè’‚å†ˆ",
    "åˆ—æ”¯æ•¦å£«ç™»",
    "åº“æ‹‰ç´¢",
    "å¡žèˆŒå°”",
    "å—æž",
    "ç›´å¸ƒç½—é™€",
    "å¤å·´",
    "æ³•ç½—ç¾¤å²›",
    "å¥¥å…°ç¾¤å²›",
    "ç™¾æ…•è¾¾",
    "ä¸œå¸æ±¶",
  ],
  en = [
    "Hong Kong",
    "Japan",
    "Singapore",
    "United States",
    "Taiwan",
    "South Korea",
    "United Kingdom",
    "France",
    "Germany",
    "Australia",
    "Macau",
    "United Arab Emirates",
    "Afghanistan",
    "Albania",
    "Algeria",
    "Angola",
    "Argentina",
    "Armenia",
    "Austria",
    "Azerbaijan",
    "Bahrain",
    "Bangladesh",
    "Belarus",
    "Belgium",
    "Belize",
    "Benin",
    "Bhutan",
    "Bolivia",
    "Bosnia and Herzegovina",
    "Botswana",
    "Brazil",
    "British Virgin Islands",
    "Brunei",
    "Bulgaria",
    "Burkina Faso",
    "Burundi",
    "Cambodia",
    "Cameroon",
    "Canada",
    "Cape Verde",
    "Cayman Islands",
    "Central African Republic",
    "Chad",
    "Chile",
    "Colombia",
    "Comoros",
    "Congo - Brazzaville",
    "Congo - Kinshasa",
    "Costa Rica",
    "Croatia",
    "Cyprus",
    "Czechia",
    "Denmark",
    "Djibouti",
    "Dominican Republic",
    "Ecuador",
    "Egypt",
    "El Salvador",
    "Equatorial Guinea",
    "Eritrea",
    "Estonia",
    "Ethiopia",
    "Fiji",
    "Finland",
    "Gabon",
    "Gambia",
    "Georgia",
    "Ghana",
    "Greece",
    "Greenland",
    "Guatemala",
    "Guinea",
    "Guyana",
    "Haiti",
    "Honduras",
    "Hungary",
    "Iceland",
    "India",
    "Indonesia",
    "Iran",
    "Iraq",
    "Ireland",
    "Isle of Man",
    "Israel",
    "Italy",
    "CÃ´te dâ€™Ivoire",
    "Jamaica",
    "Jordan",
    "Kazakhstan",
    "Kenya",
    "Kuwait",
    "Kyrgyzstan",
    "Laos",
    "Latvia",
    "Lebanon",
    "Lesotho",
    "Liberia",
    "Libya",
    "Lithuania",
    "Luxembourg",
    "North Macedonia",
    "Madagascar",
    "Malawi",
    "Malaysia",
    "Maldives",
    "Mali",
    "Malta",
    "Mauritania",
    "Mauritius",
    "Mexico",
    "Moldova",
    "Monaco",
    "Mongolia",
    "Montenegro",
    "Morocco",
    "Mozambique",
    "Myanmar",
    "Namibia",
    "Nepal",
    "Netherlands",
    "New Zealand",
    "Nicaragua",
    "Niger",
    "Nigeria",
    "North Korea",
    "Norway",
    "Oman",
    "Pakistan",
    "Panama",
    "Paraguay",
    "Peru",
    "Philippines",
    "Portugal",
    "Puerto Rico",
    "Qatar",
    "Romania",
    "Russia",
    "Rwanda",
    "San Marino",
    "Saudi Arabia",
    "Senegal",
    "Serbia",
    "Sierra Leone",
    "Slovakia",
    "Slovenia",
    "Somalia",
    "South Africa",
    "Spain",
    "Sri Lanka",
    "Sudan",
    "Suriname",
    "Eswatini",
    "Sweden",
    "Switzerland",
    "Syria",
    "Tajikistan",
    "Tanzania",
    "Thailand",
    "Togo",
    "Tonga",
    "Trinidad and Tobago",
    "Tunisia",
    "Turkey",
    "Turkmenistan",
    "U.S. Virgin Islands",
    "Uganda",
    "Ukraine",
    "Uruguay",
    "Uzbekistan",
    "Venezuela",
    "Vietnam",
    "Yemen",
    "Zambia",
    "Zimbabwe",
    "Andorra",
    "RÃ©union",
    "Poland",
    "Guam",
    "Vatican City",
    "Liechtenstein",
    "CuraÃ§ao",
    "Seychelles",
    "Antarctica",
    "Gibraltar",
    "Cuba",
    "Faroe Islands",
    "Ã…land Islands",
    "Bermuda",
    "Timor-Leste",
  ],
  flag = [
    "ðŸ‡­ðŸ‡°",
    "ðŸ‡²ðŸ‡´",
    "ðŸ‡¹ðŸ‡¼",
    "ðŸ‡¯ðŸ‡µ",
    "ðŸ‡°ðŸ‡·",
    "ðŸ‡¸ðŸ‡¬",
    "ðŸ‡ºðŸ‡¸",
    "ðŸ‡¬ðŸ‡§",
    "ðŸ‡«ðŸ‡·",
    "ðŸ‡©ðŸ‡ª",
    "ðŸ‡¦ðŸ‡º",
    "ðŸ‡¦ðŸ‡ª",
    "ðŸ‡¦ðŸ‡«",
    "ðŸ‡¦ðŸ‡±",
    "ðŸ‡©ðŸ‡¿",
    "ðŸ‡¦ðŸ‡´",
    "ðŸ‡¦ðŸ‡·",
    "ðŸ‡¦ðŸ‡²",
    "ðŸ‡¦ðŸ‡¹",
    "ðŸ‡¦ðŸ‡¿",
    "ðŸ‡§ðŸ‡­",
    "ðŸ‡§ðŸ‡©",
    "ðŸ‡§ðŸ‡¾",
    "ðŸ‡§ðŸ‡ª",
    "ðŸ‡§ðŸ‡¿",
    "ðŸ‡§ðŸ‡¯",
    "ðŸ‡§ðŸ‡¹",
    "ðŸ‡§ðŸ‡´",
    "ðŸ‡§ðŸ‡¦",
    "ðŸ‡§ðŸ‡¼",
    "ðŸ‡§ðŸ‡·",
    "ðŸ‡»ðŸ‡¬",
    "ðŸ‡§ðŸ‡³",
    "ðŸ‡§ðŸ‡¬",
    "ðŸ‡§ðŸ‡«",
    "ðŸ‡§ðŸ‡®",
    "ðŸ‡°ðŸ‡­",
    "ðŸ‡¨ðŸ‡²",
    "ðŸ‡¨ðŸ‡¦",
    "ðŸ‡¨ðŸ‡»",
    "ðŸ‡°ðŸ‡¾",
    "ðŸ‡¨ðŸ‡«",
    "ðŸ‡¹ðŸ‡©",
    "ðŸ‡¨ðŸ‡±",
    "ðŸ‡¨ðŸ‡´",
    "ðŸ‡°ðŸ‡²",
    "ðŸ‡¨ðŸ‡¬",
    "ðŸ‡¨ðŸ‡©",
    "ðŸ‡¨ðŸ‡·",
    "ðŸ‡­ðŸ‡·",
    "ðŸ‡¨ðŸ‡¾",
    "ðŸ‡¨ðŸ‡¿",
    "ðŸ‡©ðŸ‡°",
    "ðŸ‡©ðŸ‡¯",
    "ðŸ‡©ðŸ‡´",
    "ðŸ‡ªðŸ‡¨",
    "ðŸ‡ªðŸ‡¬",
    "ðŸ‡¸ðŸ‡»",
    "ðŸ‡¬ðŸ‡¶",
    "ðŸ‡ªðŸ‡·",
    "ðŸ‡ªðŸ‡ª",
    "ðŸ‡ªðŸ‡¹",
    "ðŸ‡«ðŸ‡¯",
    "ðŸ‡«ðŸ‡®",
    "ðŸ‡¬ðŸ‡¦",
    "ðŸ‡¬ðŸ‡²",
    "ðŸ‡¬ðŸ‡ª",
    "ðŸ‡¬ðŸ‡­",
    "ðŸ‡¬ðŸ‡·",
    "ðŸ‡¬ðŸ‡±",
    "ðŸ‡¬ðŸ‡¹",
    "ðŸ‡¬ðŸ‡³",
    "ðŸ‡¬ðŸ‡¾",
    "ðŸ‡­ðŸ‡¹",
    "ðŸ‡­ðŸ‡³",
    "ðŸ‡­ðŸ‡º",
    "ðŸ‡®ðŸ‡¸",
    "ðŸ‡®ðŸ‡³",
    "ðŸ‡®ðŸ‡©",
    "ðŸ‡®ðŸ‡·",
    "ðŸ‡®ðŸ‡¶",
    "ðŸ‡®ðŸ‡ª",
    "ðŸ‡®ðŸ‡²",
    "ðŸ‡®ðŸ‡±",
    "ðŸ‡®ðŸ‡¹",
    "ðŸ‡¨ðŸ‡®",
    "ðŸ‡¯ðŸ‡²",
    "ðŸ‡¯ðŸ‡´",
    "ðŸ‡°ðŸ‡¿",
    "ðŸ‡°ðŸ‡ª",
    "ðŸ‡°ðŸ‡¼",
    "ðŸ‡°ðŸ‡¬",
    "ðŸ‡±ðŸ‡¦",
    "ðŸ‡±ðŸ‡»",
    "ðŸ‡±ðŸ‡§",
    "ðŸ‡±ðŸ‡¸",
    "ðŸ‡±ðŸ‡·",
    "ðŸ‡±ðŸ‡¾",
    "ðŸ‡±ðŸ‡¹",
    "ðŸ‡±ðŸ‡º",
    "ðŸ‡²ðŸ‡°",
    "ðŸ‡²ðŸ‡¬",
    "ðŸ‡²ðŸ‡¼",
    "ðŸ‡²ðŸ‡¾",
    "ðŸ‡²ðŸ‡»",
    "ðŸ‡²ðŸ‡±",
    "ðŸ‡²ðŸ‡¹",
    "ðŸ‡²ðŸ‡·",
    "ðŸ‡²ðŸ‡º",
    "ðŸ‡²ðŸ‡½",
    "ðŸ‡²ðŸ‡©",
    "ðŸ‡²ðŸ‡¨",
    "ðŸ‡²ðŸ‡³",
    "ðŸ‡²ðŸ‡ª",
    "ðŸ‡²ðŸ‡¦",
    "ðŸ‡²ðŸ‡¿",
    "ðŸ‡²ðŸ‡²",
    "ðŸ‡³ðŸ‡¦",
    "ðŸ‡³ðŸ‡µ",
    "ðŸ‡³ðŸ‡±",
    "ðŸ‡³ðŸ‡¿",
    "ðŸ‡³ðŸ‡®",
    "ðŸ‡³ðŸ‡ª",
    "ðŸ‡³ðŸ‡¬",
    "ðŸ‡°ðŸ‡µ",
    "ðŸ‡³ðŸ‡´",
    "ðŸ‡´ðŸ‡²",
    "ðŸ‡µðŸ‡°",
    "ðŸ‡µðŸ‡¦",
    "ðŸ‡µðŸ‡¾",
    "ðŸ‡µðŸ‡ª",
    "ðŸ‡µðŸ‡­",
    "ðŸ‡µðŸ‡¹",
    "ðŸ‡µðŸ‡·",
    "ðŸ‡¶ðŸ‡¦",
    "ðŸ‡·ðŸ‡´",
    "ðŸ‡·ðŸ‡º",
    "ðŸ‡·ðŸ‡¼",
    "ðŸ‡¸ðŸ‡²",
    "ðŸ‡¸ðŸ‡¦",
    "ðŸ‡¸ðŸ‡³",
    "ðŸ‡·ðŸ‡¸",
    "ðŸ‡¸ðŸ‡±",
    "ðŸ‡¸ðŸ‡°",
    "ðŸ‡¸ðŸ‡®",
    "ðŸ‡¸ðŸ‡´",
    "ðŸ‡¿ðŸ‡¦",
    "ðŸ‡ªðŸ‡¸",
    "ðŸ‡±ðŸ‡°",
    "ðŸ‡¸ðŸ‡©",
    "ðŸ‡¸ðŸ‡·",
    "ðŸ‡¸ðŸ‡¿",
    "ðŸ‡¸ðŸ‡ª",
    "ðŸ‡¨ðŸ‡­",
    "ðŸ‡¸ðŸ‡¾",
    "ðŸ‡¹ðŸ‡¯",
    "ðŸ‡¹ðŸ‡¿",
    "ðŸ‡¹ðŸ‡­",
    "ðŸ‡¹ðŸ‡¬",
    "ðŸ‡¹ðŸ‡´",
    "ðŸ‡¹ðŸ‡¹",
    "ðŸ‡¹ðŸ‡³",
    "ðŸ‡¹ðŸ‡·",
    "ðŸ‡¹ðŸ‡²",
    "ðŸ‡»ðŸ‡®",
    "ðŸ‡ºðŸ‡¬",
    "ðŸ‡ºðŸ‡¦",
    "ðŸ‡ºðŸ‡¾",
    "ðŸ‡ºðŸ‡¿",
    "ðŸ‡»ðŸ‡ª",
    "ðŸ‡»ðŸ‡³",
    "ðŸ‡¾ðŸ‡ª",
    "ðŸ‡¿ðŸ‡²",
    "ðŸ‡¿ðŸ‡¼",
    "ðŸ‡¦ðŸ‡©",
    "ðŸ‡·ðŸ‡ª",
    "ðŸ‡µðŸ‡±",
    "ðŸ‡¬ðŸ‡º",
    "ðŸ‡»ðŸ‡¦",
    "ðŸ‡±ðŸ‡®",
    "ðŸ‡¨ðŸ‡¼",
    "ðŸ‡¸ðŸ‡¨",
    "ðŸ‡¦ðŸ‡¶",
    "ðŸ‡¬ðŸ‡®",
    "ðŸ‡¨ðŸ‡º",
    "ðŸ‡«ðŸ‡´",
    "ðŸ‡¦ðŸ‡½",
    "ðŸ‡§ðŸ‡²",
    "ðŸ‡¹ðŸ‡±",
  ];

const specialRegex = [
    /(\d\.)?\d+Ã—/,
    /IPLC|IEPL|Kern|Edge|Pro|Std|Exp|Biz|Fam|Game|Buy|Zx|LB|Game/,
  ],
  nameclear =
    /(?:å¥—é¤|åˆ°æœŸ|æœ‰æ•ˆ|å‰©ä½™|ç‰ˆæœ¬|å·²ç”¨|è¿‡æœŸ|å¤±è”|æµ‹è¯•|å®˜æ–¹|ç½‘å€|å¤‡ç”¨|ç¾¤|å®¢æœ|ç½‘ç«™|èŽ·å–|è®¢é˜…|æµé‡|æœºåœº|ä¸‹æ¬¡|å®˜å€|è”ç³»|é‚®ç®±|å·¥å•|å­¦æœ¯|æ–‡æ¡£|USE|TOTAL|EXPIRE|EMAIL|TRAFFIC|(\d\s?(?:G|T)B?))/i,
  regexArray = [
    /Ë£Â²/,
    /Ë£Â³/,
    /Ë£â´/,
    /Ë£âµ/,
    /Ë£â¶/,
    /Ë£â·/,
    /Ë£â¸/,
    /Ë£â¹/,
    /Ë£Â¹â°/,
    /Ë£Â²â°/,
    /Ë£Â³â°/,
    /Ë£â´â°/,
    /Ë£âµâ°/,
    /IPLC/i,
    /IEPL/i,
    /æ ¸å¿ƒ/,
    /è¾¹ç¼˜/,
    /é«˜çº§/,
    /æ ‡å‡†/,
    /å®žéªŒ/,
    /å•†å®½/,
    /å®¶å®½/,
    /æ¸¸æˆ|game/i,
    /è´­ç‰©/,
    /ä¸“çº¿/,
    /LB/,
    /CLOUDFLARE/i,
    /\bUDP\b/i,
    /\bGPT\b/i,
    /UDPN\b/,
    /EONS/i,
    /NEAROUTE/i,
    /HKT/i,
    /ALIYUN/i,
    /HKBN/i,
    /I-CABLE/i,
    /JINX/i,
    /MISAKA/i,
    /DMIT/i,
    /AKARI/i,
    /SEEDNET/i,
    /PQS/i,
    /APOL/i,
    /AKILE/i,
    /SG\.GS/i,
    /DIGITALOCEAN/i,
    /AWS/i,
    /SINGTEL/i,
    /NEROCLOUD/i,
    /TERABIX/i,
    /TM/i,
    /CAT/i,
    /BANGMOD/i,
    /EXETEL/i,
    /ORACLE/i,
    /VERIZON/i,
    /AT&T/i,
    /FRONTIER/i,
    /COMCAST/i,
    /VIDEOTRON/i,
    /WEBCONEX/i,
    /VODAFONE/i,
    /BT/i,
    /LG/i,
    /SK/i,
    /KT/i,
    /SEJONG/i,
    /KDDI/i,
    /MIKU/i,
    /BIGLOBE/i,
    /HINET/i,
    /BAGE/i,
    /SOFTBANK/i,
    /SONET/i,
    /EASTERN/i,
  ],
  valueArray = [
    "2Ã—",
    "3Ã—",
    "4Ã—",
    "5Ã—",
    "6Ã—",
    "7Ã—",
    "8Ã—",
    "9Ã—",
    "10Ã—",
    "20Ã—",
    "30Ã—",
    "40Ã—",
    "50Ã—",
    "IPLC",
    "IEPL",
    "Kern",
    "Edge",
    "Pro",
    "Std",
    "Exp",
    "Biz",
    "Fam",
    "Game",
    "Buy",
    "Zx",
    "LB",
    "CF",
    "UDP",
    "GPT",
    "UDPN",
    "Eons",
    "Nearoute",
    "HKT",
    "Aliyun",
    "HKBN",
    "i-Cable",
    "Jinx",
    "Misaka",
    "Dmit",
    "Akari",
    "Seednet",
    "PQS",
    "Apol",
    "Akile",
    "SG.GS",
    "DigitalOcean",
    "AWS",
    "Singtel",
    "Nerocloud",
    "Terabix",
    "TM",
    "CAT",
    "Bangmod",
    "Exetel",
    "Oracle",
    "Verizon",
    "AT&T",
    "Frontier",
    "Comcast",
    "Videotron",
    "Webconex",
    "Vodafone",
    "BT",
    "LG",
    "SK",
    "KT",
    "Sejong",
    "KDDI",
    "Miku",
    "Biglobe",
    "Hinet",
    "Bage",
    "SoftBank",
    "SoNet",
    "Eastern",
  ],
  nameblnx = /(é«˜å€|(?!1)2+(x|å€)|Ë£Â²|Ë£Â³|Ë£â´|Ë£âµ|Ë£Â¹â°)/i,
  namenx = /(é«˜å€|(?!1)(0\.|\d)+(x|å€)|Ë£Â²|Ë£Â³|Ë£â´|Ë£âµ|Ë£Â¹â°)/i,
  rurekey = {
    GB: /UK/g,
    "B-G-P": /BGP/g,
    "Russia Moscow": /Moscow/g,
    "Korea Chuncheon": /Chuncheon|Seoul/g,
    "Hong Kong": /Hongkong|HONG KONG/gi,
    "United Kingdom London": /London|Great Britain/g,
    "Dubai United Arab Emirates": /United Arab Emirates/g,
    "Taiwan TW å°æ¹¾ ðŸ‡¹ðŸ‡¼": /(å°|Tai\s?wan|TW).*?ðŸ‡¨ðŸ‡³|ðŸ‡¨ðŸ‡³.*?(å°|Tai\s?wan|TW)/g,
    "United States": /USA|Los Angeles|San Jose|Silicon Valley|Michigan/g,
    æ¾³å¤§åˆ©äºš: /æ¾³æ´²|å¢¨å°”æœ¬|æ‚‰å°¼|åœŸæ¾³|(æ·±|æ²ª|å‘¼|äº¬|å¹¿|æ­)æ¾³/g,
    å¾·å›½: /(æ·±|æ²ª|å‘¼|äº¬|å¹¿|æ­)å¾·(?!.*(I|çº¿))|æ³•å…°å…‹ç¦|æ»¬å¾·/g,
    é¦™æ¸¯: /(æ·±|æ²ª|å‘¼|äº¬|å¹¿|æ­)æ¸¯(?!.*(I|çº¿))/g,
    æ—¥æœ¬: /(æ·±|æ²ª|å‘¼|äº¬|å¹¿|æ­|ä¸­|è¾½)æ—¥(?!.*(I|çº¿))|ä¸œäº¬|å¤§å‚/g,
    æ–°åŠ å¡: /ç‹®åŸŽ|(æ·±|æ²ª|å‘¼|äº¬|å¹¿|æ­)æ–°/g,
    ç¾Žå›½: /(æ·±|æ²ª|å‘¼|äº¬|å¹¿|æ­)ç¾Ž|æ³¢ç‰¹å…°|èŠåŠ å“¥|å“¥ä¼¦å¸ƒ|çº½çº¦|ç¡…è°·|ä¿„å‹’å†ˆ|è¥¿é›…å›¾|èŠåŠ å“¥/g,
    æ³¢æ–¯å°¼äºšå’Œé»‘å¡žå“¥ç»´é‚£: /æ³¢é»‘å…±å’Œå›½/g,
    å°å°¼: /å°åº¦å°¼è¥¿äºš|é›…åŠ è¾¾/g,
    å°åº¦: /å­Ÿä¹°/g,
    é˜¿è”é…‹: /è¿ªæ‹œ|é˜¿æ‹‰ä¼¯è”åˆé…‹é•¿å›½/g,
    å­ŸåŠ æ‹‰å›½: /å­ŸåŠ æ‹‰/g,
    æ·å…‹: /æ·å…‹å…±å’Œå›½/g,
    å°æ¹¾: /æ–°å°|æ–°åŒ—|å°(?!.*çº¿)/g,
    Taiwan: /Taipei/g,
    éŸ©å›½: /æ˜¥å·|éŸ©|é¦–å°”/g,
    Japan: /Tokyo|Osaka/g,
    è‹±å›½: /ä¼¦æ•¦/g,
    India: /Mumbai/g,
    Germany: /Frankfurt/g,
    Switzerland: /Zurich/g,
    ä¿„ç½—æ–¯: /èŽ«æ–¯ç§‘/g,
    åœŸè€³å…¶: /ä¼Šæ–¯å¦å¸ƒå°”/g,
    æ³°å›½: /æ³°åœ‹|æ›¼è°·/g,
    æ³•å›½: /å·´é»Ž/g,
    G: /\d\s?GB/gi,
    Esnc: /esnc/gi,
  };

function operator(proxies) {
  const allMap = {};
  switch (inArg.in) {
    case "flag":
      inCountry = flag;
      break;
    case "en":
      inCountry = en;
      break;
    case "zh":
      inCountry = zh;
      break;
    case "abbr":
      inCountry = abbr;
      break;
    default:
      inCountry = [flag, en, zh, abbr];
  }
  switch (inArg.out) {
    case "flag":
      outCountry = flag;
      break;
    case "en":
      outCountry = en;
      break;
    case "zh":
      outCountry = zh;
      break;
    default:
      outCountry = abbr;
  }
  inCountry.forEach((arr) =>
    arr.forEach((value, index) => (allMap[value] = outCountry[index]))
  );
  if (clear) proxies = proxies.filter((proxy) => !nameclear.test(proxy.name));
  if (nx) proxies = proxies.filter((proxy) => !namenx.test(proxy.name));
  if (blnx) proxies = proxies.filter((proxy) => nameblnx.test(proxy.name));
  if (addflag) {
    for (const proxy of proxies) {
      const nameBak = proxy.name;
      let nameCache = nameBak;
      for (const [rk, reg] of Object.entries(rurekey))
        nameCache = nameCache.replace(reg, rk);
      let retainKeys = [];
      if (BLKEY)
        for (const k of BLKEY.split("+")) {
          const part = k.split(">");
          if (part[1]) {
            if (nameBak.includes(part[0])) retainKeys.push(part[1]);
          } else if (nameBak.includes(k)) retainKeys.push(k);
        }
      proxy["block-quic"] = /^(on|off)$/.test(blockquic)
        ? blockquic
        : (delete proxy["block-quic"], undefined);
      let ikey = "",
        ikeys = "";
      if (blgd)
        for (let i = 0; i < regexArray.length; i++)
          regexArray[i].test(nameBak) && (ikeys = valueArray[i]);
      if (bl) {
        const m = nameBak.match(
          /(?:å€çŽ‡|[XxÃ—])\D?((?:\d{1,3}\.)?\d+)|((?:\d{1,3}\.)?\d+)(?:å€|[XxÃ—])/
        );
        if (m) {
          const rev = m[1] || m[2];
          rev !== "1" && (ikey = rev + "Ã—");
        }
      }
      const keyVal =
        Object.entries(allMap).find(([k]) => nameCache.includes(k))?.[1] ||
        ((m = nameCache.match(/[æ¾³å¾·æ¸¯æ—¥æ–°å¡ç¾Žå°éŸ©ä¿„æ³°æ³•]/))
          ? {
              æ¾³: "AU",
              å¾·: "DE",
              æ¸¯: "HK",
              æ—¥: "JP",
              å¡: "SG",
              ç¾Ž: "US",
              å°: "TW",
              éŸ©: "KR",
              ä¿„: "RU",
              æ³°: "TH",
              æ³•: "FR",
            }[m[0]]
          : null);
      if (keyVal) {
        const idx = outCountry.indexOf(keyVal);
        if (idx == -1)
          proxy.name = [FNAME, keyVal, retainKeys.join(FGF), ikey, ikeys]
            .filter(Boolean)
            .join(FGF);
        else {
          if (nf)
            proxy.name = [
              FNAME,
              flag[idx] === "ðŸ‡¹ðŸ‡¼" ? "ðŸ‡¨ðŸ‡³" : flag[idx],
              keyVal,
              retainKeys.join(FGF),
              ikey,
              ikeys,
            ]
              .filter(Boolean)
              .join(FGF);
          else
            proxy.name = [
              flag[idx] === "ðŸ‡¹ðŸ‡¼" ? "ðŸ‡¨ðŸ‡³" : flag[idx],
              FNAME,
              keyVal,
              retainKeys.join(FGF),
              ikey,
              ikeys,
            ]
              .filter(Boolean)
              .join(FGF);
        }
      } else proxy.name = nm ? FNAME + nameBak : null;
    }
  } else {
    for (const proxy of proxies) {
      const nameBak = proxy.name;
      let nameCache = nameBak;
      for (const [rk, reg] of Object.entries(rurekey))
        nameCache = nameCache.replace(reg, rk);
      let retainKeys = [];
      if (BLKEY)
        for (const k of BLKEY.split("+")) {
          const part = k.split(">");
          if (nameBak.includes(part[0])) retainKeys.push(part[1] || part[0]);
        }
      proxy["block-quic"] = /^(on|off)$/.test(blockquic)
        ? blockquic
        : (delete proxy["block-quic"], undefined);
      let ikey = "",
        ikeys = "";
      if (blgd)
        for (let i = 0; i < regexArray.length; i++)
          regexArray[i].test(nameBak) && (ikeys = valueArray[i]);
      if (bl) {
        const m = nameBak.match(
          /(?:å€çŽ‡|[XxÃ—])\D?((?:\d{1,3}\.)?\d+)|((?:\d{1,3}\.)?\d+)(?:å€|[XxÃ—])/
        );
        if (m) {
          const rev = m[1] || m[2];
          rev !== "1" && (ikey = rev + "Ã—");
        }
      }
      const keyVal =
        Object.entries(allMap).find(([k]) => nameCache.includes(k))?.[1] ||
        ((m = nameCache.match(/[æ¾³å¾·æ¸¯æ—¥æ–°å¡ç¾Žå°éŸ©ä¿„æ³°æ³•]/))
          ? {
              æ¾³: "AU",
              å¾·: "DE",
              æ¸¯: "HK",
              æ—¥: "JP",
              å¡: "SG",
              ç¾Ž: "US",
              å°: "TW",
              éŸ©: "KR",
              ä¿„: "RU",
              æ³°: "TH",
              æ³•: "FR",
            }[m[0]]
          : null);
      if (keyVal)
        proxy.name = [FNAME, keyVal, retainKeys.join(FGF), ikey, ikeys]
          .filter(Boolean)
          .join(FGF);
      else proxy.name = nm ? FNAME + nameBak : null;
    }
  }
  proxies = proxies.filter((x) => x.name);
  const groups = new Map();
  for (const x of proxies) {
    let g = groups.get(x.name);
    if (g) {
      g.count++;
      g.items.push({
        ...x,
        name: `${x.name}${XHFGF}${g.count.toString().padStart(2, "0")}`,
      });
    } else
      groups.set(x.name, {
        count: 1,
        items: [{ ...x, name: `${x.name}${XHFGF}01` }],
      });
  }
  proxies = [].concat(...Array.from(groups.values(), (g) => g.items));
  if (inArg.one || false) {
    const groups = new Map();
    for (const x of proxies) {
      const k = x.name.replace(
        /[^A-Za-z0-9\u00C0-\u017F\u4E00-\u9FFF]+\d+$/,
        ""
      );
      let arr = groups.get(k);
      if (!arr) groups.set(k, (arr = []));
      arr.push(x);
    }
    for (const arr of groups.values())
      if (arr.length === 1 && arr[0].name.endsWith("01"))
        arr[0].name = arr[0].name.replace(/[^.]01/, "");
  }
  if (blpx) {
    const wis = [],
      wnout = [];
    for (let i = 0; i < proxies.length; i++) {
      const x = proxies[i];
      if (specialRegex.some((r) => r.test(x.name)))
        wis.push({ x, i, sp: specialRegex.findIndex((r) => r.test(x.name)) });
      else wnout.push({ x, i });
    }
    wis.sort((a, b) => a.sp - b.sp || a.x.name.localeCompare(b.x.name));
    return wnout
      .sort((a, b) => a.i - b.i)
      .map((o) => o.x)
      .concat(wis.map((o) => o.x));
  }
  return proxies;
}
