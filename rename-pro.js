const provider = $arguments.provider ?? "Provider",
  out = $arguments.out ?? "abbr",
  geoData = {
    "ðŸ‡­ðŸ‡°": { full: "Hong Kong", abbr: "HK" },
    "ðŸ‡¯ðŸ‡µ": { full: "Japan", abbr: "JP" },
    "ðŸ‡¸ðŸ‡¬": { full: "Singapore", abbr: "SG" },
    "ðŸ‡ºðŸ‡¸": { full: "United States", abbr: "US" },
    "ðŸ‡¹ðŸ‡¼": { full: "Taiwan", abbr: "TW" },
    "ðŸ‡¨ðŸ‡³": { full: "Taiwan", abbr: "TW" },
    "ðŸ‡°ðŸ‡·": { full: "South Korea", abbr: "KR" },
    "ðŸ‡³ðŸ‡±": { full: "Netherlands", abbr: "NL" },
    "ðŸ‡©ðŸ‡ª": { full: "Germany", abbr: "DE" },
    "ðŸ‡¬ðŸ‡§": { full: "United Kingdom", abbr: "GB" },
    "ðŸ‡²ðŸ‡´": { full: "Macao", abbr: "MO" },
    "ðŸ‡«ðŸ‡·": { full: "France", abbr: "FR" },
    "ðŸ‡¦ðŸ‡º": { full: "Australia", abbr: "AU" },
    "ðŸ‡¦ðŸ‡ª": { full: "United Arab Emirates", abbr: "AE" },
    "ðŸ‡¦ðŸ‡«": { full: "Afghanistan", abbr: "AF" },
    "ðŸ‡¦ðŸ‡±": { full: "Albania", abbr: "AL" },
    "ðŸ‡©ðŸ‡¿": { full: "Algeria", abbr: "DZ" },
    "ðŸ‡¦ðŸ‡´": { full: "Angola", abbr: "AO" },
    "ðŸ‡¦ðŸ‡·": { full: "Argentina", abbr: "AR" },
    "ðŸ‡¦ðŸ‡²": { full: "Armenia", abbr: "AM" },
    "ðŸ‡¦ðŸ‡¹": { full: "Austria", abbr: "AT" },
    "ðŸ‡¦ðŸ‡¿": { full: "Azerbaijan", abbr: "AZ" },
    "ðŸ‡§ðŸ‡­": { full: "Bahrain", abbr: "BH" },
    "ðŸ‡§ðŸ‡©": { full: "Bangladesh", abbr: "BD" },
    "ðŸ‡§ðŸ‡¾": { full: "Belarus", abbr: "BY" },
    "ðŸ‡§ðŸ‡ª": { full: "Belgium", abbr: "BE" },
    "ðŸ‡§ðŸ‡¿": { full: "Belize", abbr: "BZ" },
    "ðŸ‡§ðŸ‡¯": { full: "Benin", abbr: "BJ" },
    "ðŸ‡§ðŸ‡¹": { full: "Bhutan", abbr: "BT" },
    "ðŸ‡§ðŸ‡´": { full: "Bolivia", abbr: "BO" },
    "ðŸ‡§ðŸ‡¦": { full: "Bosnia and Herzegovina", abbr: "BA" },
    "ðŸ‡§ðŸ‡¼": { full: "Botswana", abbr: "BW" },
    "ðŸ‡§ðŸ‡·": { full: "Brazil", abbr: "BR" },
    "ðŸ‡»ðŸ‡¬": { full: "British Virgin Islands", abbr: "VG" },
    "ðŸ‡§ðŸ‡³": { full: "Brunei", abbr: "BN" },
    "ðŸ‡§ðŸ‡¬": { full: "Bulgaria", abbr: "BG" },
    "ðŸ‡§ðŸ‡«": { full: "Burkina Faso", abbr: "BF" },
    "ðŸ‡§ðŸ‡®": { full: "Burundi", abbr: "BI" },
    "ðŸ‡°ðŸ‡­": { full: "Cambodia", abbr: "KH" },
    "ðŸ‡¨ðŸ‡²": { full: "Cameroon", abbr: "CM" },
    "ðŸ‡¨ðŸ‡¦": { full: "Canada", abbr: "CA" },
    "ðŸ‡¨ðŸ‡»": { full: "Cape Verde", abbr: "CV" },
    "ðŸ‡°ðŸ‡¾": { full: "Cayman Islands", abbr: "KY" },
    "ðŸ‡¨ðŸ‡«": { full: "Central African Republic", abbr: "CF" },
    "ðŸ‡¹ðŸ‡©": { full: "Chad", abbr: "TD" },
    "ðŸ‡¨ðŸ‡±": { full: "Chile", abbr: "CL" },
    "ðŸ‡¨ðŸ‡´": { full: "Colombia", abbr: "CO" },
    "ðŸ‡°ðŸ‡²": { full: "Comoros", abbr: "KM" },
    "ðŸ‡¨ðŸ‡¬": { full: "Congo - Brazzaville", abbr: "CG" },
    "ðŸ‡¨ðŸ‡©": { full: "Congo - Kinshasa", abbr: "CD" },
    "ðŸ‡¨ðŸ‡·": { full: "Costa Rica", abbr: "CR" },
    "ðŸ‡­ðŸ‡·": { full: "Croatia", abbr: "HR" },
    "ðŸ‡¨ðŸ‡¾": { full: "Cyprus", abbr: "CY" },
    "ðŸ‡¨ðŸ‡¿": { full: "Czechia", abbr: "CZ" },
    "ðŸ‡©ðŸ‡°": { full: "Denmark", abbr: "DK" },
    "ðŸ‡©ðŸ‡¯": { full: "Djibouti", abbr: "DJ" },
    "ðŸ‡©ðŸ‡´": { full: "Dominican Republic", abbr: "DO" },
    "ðŸ‡ªðŸ‡¨": { full: "Ecuador", abbr: "EC" },
    "ðŸ‡ªðŸ‡¬": { full: "Egypt", abbr: "EG" },
    "ðŸ‡¸ðŸ‡»": { full: "El Salvador", abbr: "SV" },
    "ðŸ‡¬ðŸ‡¶": { full: "Equatorial Guinea", abbr: "GQ" },
    "ðŸ‡ªðŸ‡·": { full: "Eritrea", abbr: "ER" },
    "ðŸ‡ªðŸ‡ª": { full: "Estonia", abbr: "EE" },
    "ðŸ‡ªðŸ‡¹": { full: "Ethiopia", abbr: "ET" },
    "ðŸ‡«ðŸ‡¯": { full: "Fiji", abbr: "FJ" },
    "ðŸ‡«ðŸ‡®": { full: "Finland", abbr: "FI" },
    "ðŸ‡¬ðŸ‡¦": { full: "Gabon", abbr: "GA" },
    "ðŸ‡¬ðŸ‡²": { full: "Gambia", abbr: "GM" },
    "ðŸ‡¬ðŸ‡ª": { full: "Georgia", abbr: "GE" },
    "ðŸ‡¬ðŸ‡­": { full: "Ghana", abbr: "GH" },
    "ðŸ‡¬ðŸ‡·": { full: "Greece", abbr: "GR" },
    "ðŸ‡¬ðŸ‡±": { full: "Greenland", abbr: "GL" },
    "ðŸ‡¬ðŸ‡¹": { full: "Guatemala", abbr: "GT" },
    "ðŸ‡¬ðŸ‡³": { full: "Guinea", abbr: "GN" },
    "ðŸ‡¬ðŸ‡¾": { full: "Guyana", abbr: "GY" },
    "ðŸ‡­ðŸ‡¹": { full: "Haiti", abbr: "HT" },
    "ðŸ‡­ðŸ‡³": { full: "Honduras", abbr: "HN" },
    "ðŸ‡­ðŸ‡º": { full: "Hungary", abbr: "HU" },
    "ðŸ‡®ðŸ‡¸": { full: "Iceland", abbr: "IS" },
    "ðŸ‡®ðŸ‡³": { full: "India", abbr: "IN" },
    "ðŸ‡®ðŸ‡©": { full: "Indonesia", abbr: "ID" },
    "ðŸ‡®ðŸ‡·": { full: "Iran", abbr: "IR" },
    "ðŸ‡®ðŸ‡¶": { full: "Iraq", abbr: "IQ" },
    "ðŸ‡®ðŸ‡ª": { full: "Ireland", abbr: "IE" },
    "ðŸ‡®ðŸ‡²": { full: "Isle of Man", abbr: "IM" },
    "ðŸ‡®ðŸ‡±": { full: "Israel", abbr: "IL" },
    "ðŸ‡®ðŸ‡¹": { full: "Italy", abbr: "IT" },
    "ðŸ‡¨ðŸ‡®": { full: "CÃ´te dâ€™Ivoire", abbr: "CI" },
    "ðŸ‡¯ðŸ‡²": { full: "Jamaica", abbr: "JM" },
    "ðŸ‡¯ðŸ‡´": { full: "Jordan", abbr: "JO" },
    "ðŸ‡°ðŸ‡¿": { full: "Kazakhstan", abbr: "KZ" },
    "ðŸ‡°ðŸ‡ª": { full: "Kenya", abbr: "KE" },
    "ðŸ‡°ðŸ‡¼": { full: "Kuwait", abbr: "KW" },
    "ðŸ‡°ðŸ‡¬": { full: "Kyrgyzstan", abbr: "KG" },
    "ðŸ‡±ðŸ‡¦": { full: "Laos", abbr: "LA" },
    "ðŸ‡±ðŸ‡»": { full: "Latvia", abbr: "LV" },
    "ðŸ‡±ðŸ‡§": { full: "Lebanon", abbr: "LB" },
    "ðŸ‡±ðŸ‡¸": { full: "Lesotho", abbr: "LS" },
    "ðŸ‡±ðŸ‡·": { full: "Liberia", abbr: "LR" },
    "ðŸ‡±ðŸ‡¾": { full: "Libya", abbr: "LY" },
    "ðŸ‡±ðŸ‡¹": { full: "Lithuania", abbr: "LT" },
    "ðŸ‡±ðŸ‡º": { full: "Luxembourg", abbr: "LU" },
    "ðŸ‡²ðŸ‡°": { full: "North Macedonia", abbr: "MK" },
    "ðŸ‡²ðŸ‡¬": { full: "Madagascar", abbr: "MG" },
    "ðŸ‡²ðŸ‡¼": { full: "Malawi", abbr: "MW" },
    "ðŸ‡²ðŸ‡¾": { full: "Malaysia", abbr: "MY" },
    "ðŸ‡²ðŸ‡»": { full: "Maldives", abbr: "MV" },
    "ðŸ‡²ðŸ‡±": { full: "Mali", abbr: "ML" },
    "ðŸ‡²ðŸ‡¹": { full: "Malta", abbr: "MT" },
    "ðŸ‡²ðŸ‡·": { full: "Mauritania", abbr: "MR" },
    "ðŸ‡²ðŸ‡º": { full: "Mauritius", abbr: "MU" },
    "ðŸ‡²ðŸ‡½": { full: "Mexico", abbr: "MX" },
    "ðŸ‡²ðŸ‡©": { full: "Moldova", abbr: "MD" },
    "ðŸ‡²ðŸ‡¨": { full: "Monaco", abbr: "MC" },
    "ðŸ‡²ðŸ‡³": { full: "Mongolia", abbr: "MN" },
    "ðŸ‡²ðŸ‡ª": { full: "Montenegro", abbr: "ME" },
    "ðŸ‡²ðŸ‡¦": { full: "Morocco", abbr: "MA" },
    "ðŸ‡²ðŸ‡¿": { full: "Mozambique", abbr: "MZ" },
    "ðŸ‡²ðŸ‡²": { full: "Myanmar", abbr: "MM" },
    "ðŸ‡³ðŸ‡¦": { full: "Namibia", abbr: "NA" },
    "ðŸ‡³ðŸ‡µ": { full: "Nepal", abbr: "NP" },
    "ðŸ‡³ðŸ‡¿": { full: "New Zealand", abbr: "NZ" },
    "ðŸ‡³ðŸ‡®": { full: "Nicaragua", abbr: "NI" },
    "ðŸ‡³ðŸ‡ª": { full: "Niger", abbr: "NE" },
    "ðŸ‡³ðŸ‡¬": { full: "Nigeria", abbr: "NG" },
    "ðŸ‡°ðŸ‡µ": { full: "North Korea", abbr: "KP" },
    "ðŸ‡³ðŸ‡´": { full: "Norway", abbr: "NO" },
    "ðŸ‡´ðŸ‡²": { full: "Oman", abbr: "OM" },
    "ðŸ‡µðŸ‡°": { full: "Pakistan", abbr: "PK" },
    "ðŸ‡µðŸ‡¦": { full: "Panama", abbr: "PA" },
    "ðŸ‡µðŸ‡¾": { full: "Paraguay", abbr: "PY" },
    "ðŸ‡µðŸ‡ª": { full: "Peru", abbr: "PE" },
    "ðŸ‡µðŸ‡­": { full: "Philippines", abbr: "PH" },
    "ðŸ‡µðŸ‡¹": { full: "Portugal", abbr: "PT" },
    "ðŸ‡µðŸ‡·": { full: "Puerto Rico", abbr: "PR" },
    "ðŸ‡¶ðŸ‡¦": { full: "Qatar", abbr: "QA" },
    "ðŸ‡·ðŸ‡´": { full: "Romania", abbr: "RO" },
    "ðŸ‡·ðŸ‡º": { full: "Russia", abbr: "RU" },
    "ðŸ‡·ðŸ‡¼": { full: "Rwanda", abbr: "RW" },
    "ðŸ‡¸ðŸ‡²": { full: "San Marino", abbr: "SM" },
    "ðŸ‡¸ðŸ‡¦": { full: "Saudi Arabia", abbr: "SA" },
    "ðŸ‡¸ðŸ‡³": { full: "Senegal", abbr: "SN" },
    "ðŸ‡·ðŸ‡¸": { full: "Serbia", abbr: "RS" },
    "ðŸ‡¸ðŸ‡±": { full: "Sierra Leone", abbr: "SL" },
    "ðŸ‡¸ðŸ‡°": { full: "Slovakia", abbr: "SK" },
    "ðŸ‡¸ðŸ‡®": { full: "Slovenia", abbr: "SI" },
    "ðŸ‡¸ðŸ‡´": { full: "Somalia", abbr: "SO" },
    "ðŸ‡¿ðŸ‡¦": { full: "South Africa", abbr: "ZA" },
    "ðŸ‡ªðŸ‡¸": { full: "Spain", abbr: "ES" },
    "ðŸ‡±ðŸ‡°": { full: "Sri Lanka", abbr: "LK" },
    "ðŸ‡¸ðŸ‡©": { full: "Sudan", abbr: "SD" },
    "ðŸ‡¸ðŸ‡·": { full: "Suriname", abbr: "SR" },
    "ðŸ‡¸ðŸ‡¿": { full: "Eswatini", abbr: "SZ" },
    "ðŸ‡¸ðŸ‡ª": { full: "Sweden", abbr: "SE" },
    "ðŸ‡¨ðŸ‡­": { full: "Switzerland", abbr: "CH" },
    "ðŸ‡¸ðŸ‡¾": { full: "Syria", abbr: "SY" },
    "ðŸ‡¹ðŸ‡¯": { full: "Tajikistan", abbr: "TJ" },
    "ðŸ‡¹ðŸ‡¿": { full: "Tanzania", abbr: "TZ" },
    "ðŸ‡¹ðŸ‡­": { full: "Thailand", abbr: "TH" },
    "ðŸ‡¹ðŸ‡¬": { full: "Togo", abbr: "TG" },
    "ðŸ‡¹ðŸ‡´": { full: "Tonga", abbr: "TO" },
    "ðŸ‡¹ðŸ‡¹": { full: "Trinidad and Tobago", abbr: "TT" },
    "ðŸ‡¹ðŸ‡³": { full: "Tunisia", abbr: "TN" },
    "ðŸ‡¹ðŸ‡·": { full: "Turkey", abbr: "TR" },
    "ðŸ‡¹ðŸ‡²": { full: "Turkmenistan", abbr: "TM" },
    "ðŸ‡»ðŸ‡®": { full: "U.S. Virgin Islands", abbr: "VI" },
    "ðŸ‡ºðŸ‡¬": { full: "Uganda", abbr: "UG" },
    "ðŸ‡ºðŸ‡¦": { full: "Ukraine", abbr: "UA" },
    "ðŸ‡ºðŸ‡¾": { full: "Uruguay", abbr: "UY" },
    "ðŸ‡ºðŸ‡¿": { full: "Uzbekistan", abbr: "UZ" },
    "ðŸ‡»ðŸ‡ª": { full: "Venezuela", abbr: "VE" },
    "ðŸ‡»ðŸ‡³": { full: "Vietnam", abbr: "VN" },
    "ðŸ‡¾ðŸ‡ª": { full: "Yemen", abbr: "YE" },
    "ðŸ‡¿ðŸ‡²": { full: "Zambia", abbr: "ZM" },
    "ðŸ‡¿ðŸ‡¼": { full: "Zimbabwe", abbr: "ZW" },
    "ðŸ‡¦ðŸ‡©": { full: "Andorra", abbr: "AD" },
    "ðŸ‡·ðŸ‡ª": { full: "RÃ©union", abbr: "RE" },
    "ðŸ‡µðŸ‡±": { full: "Poland", abbr: "PL" },
    "ðŸ‡¬ðŸ‡º": { full: "Guam", abbr: "GU" },
    "ðŸ‡»ðŸ‡¦": { full: "Vatican City", abbr: "VA" },
    "ðŸ‡±ðŸ‡®": { full: "Liechtenstein", abbr: "LI" },
    "ðŸ‡¨ðŸ‡¼": { full: "CuraÃ§ao", abbr: "CW" },
    "ðŸ‡¸ðŸ‡¨": { full: "Seychelles", abbr: "SC" },
    "ðŸ‡¦ðŸ‡¶": { full: "Antarctica", abbr: "AQ" },
    "ðŸ‡¬ðŸ‡®": { full: "Gibraltar", abbr: "GI" },
    "ðŸ‡¨ðŸ‡º": { full: "Cuba", abbr: "CU" },
    "ðŸ‡«ðŸ‡´": { full: "Faroe Islands", abbr: "FO" },
    "ðŸ‡¦ðŸ‡½": { full: "Ã…land Islands", abbr: "AX" },
    "ðŸ‡§ðŸ‡²": { full: "Bermuda", abbr: "BM" },
    "ðŸ‡¹ðŸ‡±": { full: "Timor-Leste", abbr: "TL" },
  },
  abMap = Object.values(geoData).reduce((m, o) => ((m[o.abbr] = o), m), {});

const flag = $server.name.match(/^[\u{1F1E6}-\u{1F1FF}]{2}/u)?.[0] || "",
  words = [
    ...new Intl.Segmenter(undefined, { granularity: "word" }).segment(
      $server.name.replace(flag, "").trim()
    ),
  ]
    .filter((s) => s.isWordLike || /[-.]/.test(s.segment))
    .map((s) => s.segment),
  country =
    flag && geoData[flag]
      ? geoData[flag][out]
      : words[0]
      ? abMap[words[0].slice(0, 2).toUpperCase()]?.[out]
      : "",
  processed = [provider + " " + country].concat(
    words.slice(1).filter((x) => !/Ë£|\b(x\d+|\d+x)/i.test(x.replace(/Ë£/g, "")))
  );

$server.name =
  flag +
  " " +
  processed.reduce((a, c) =>
    /[-.]$/.test(a) || /^[-.]/.test(c) ? a + c : a + " " + c
  );
